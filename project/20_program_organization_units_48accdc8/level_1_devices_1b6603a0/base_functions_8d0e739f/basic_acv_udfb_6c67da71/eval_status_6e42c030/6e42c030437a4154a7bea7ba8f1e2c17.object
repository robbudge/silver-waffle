{"payload":{"meta":{"Graph":{"@Type":"81297157","@Value":{"Guid":"(Guid)6e42c030-437a-4154-a7be-a7ba8f1e2c17","ParentGuid":"(Guid)6c67da71-8abf-4bfd-903b-98e7a89c060e","Name":"(string)Eval_Status","Properties":{"@Type":"2c41fa04:IDictionary","@Value":{}},"TypeGuid":"(Guid)8ac092e5-3128-4e26-9e7e-11016c6684f2","EmbeddedTypeGuids":{"@Type":"[Guid]","@Value":["(Guid)3b83b776-fb25-43b8-99f2-3c507c9143fc"]}}},"TypeInfos":{"2c41fa04":"{2c41fa04-1834-41c1-816e-303c7aa2c05b}","81297157":"{81297157-7ec9-45ce-845e-84cab2b88ade}","Guid":"System.Guid","string":"System.String"}},"object":{"Graph":{"@Type":"8ac092e5","@Value":{"Implementation":{"@Type":"3b83b776","@Value":{"TextDocument":{"@Type":"f3878285","@Value":{"TextBlobForSerialisation":"(string)Active_Ton(IN:=\t(valve.Valve_Actual=PosArray[tIndex]),PT:=T#1S);\n\n//MEM.MemMove(pSource:= ADR(Trend[1]), pDestination:=ADR(Trend[0]) , uiNumberOfBytes:=(SIZEOF(Trend)-4) );\n//Trend[14]:=valve.Valve_Actual;\n\n//Trend_Detect(x:=Valve.Valve_Actual);\n\n\nIF lcl_Status=eACV_Status.OFFLINE THEN\t\n\ttIndex:=0;\n\tDataOK:=FALSE;\n\tPosChange:=0;\n\tOldPos:=0;\n\ttIndex:=(tIndex+1) MOD 5;\n\tPosArray[tIndex]:=0;\nELSE\n\tIF valve.Valve_Actual<> (PosArray[tIndex]) OR Active_Ton.q\tTHEN\n\t\ttIndex:=(tIndex+1) MOD 5;\n\t\tPosArray[tIndex]:=LIMIT(0,valve.Valve_Actual,100);\n\t\tOldPos:=LIMIT(0,Burkert_OSCAT_BASIC.ARRAY_AVG(ADR(PosArray),SIZEOF(PosArray)),100);\n\t\t\n\tEND_IF;\nEND_IF;\nPosChange:=(LIMIT(0,Valve.Valve_Actual,100)-OldPos);\n\nIF tIndex=4 THEN\tDataOK:=TRUE; END_IF;\n\nControl_Error:=ABS(Valve.Valve_Actual-Output);\nTon_1(In:=(ABS(Valve.Valve_Actual-Output) > error_PCT),PT:=(INT_TO_TIME(Error_Delay_S))*1000);\nIF Ton_1.Q THEN lcl_Status:=eACV_Status.Pos_Error;  END_IF;\n\nIF Valve.Mode.eMode=eACV_Modes.Auto OR Valve.Mode.eMode=eACV_Modes.Simulate THEN\t\n\tIF Valve.Valve_Actual>3 AND Valve.Valve_Actual<97 THEN \tlcl_Status:=eACV_Status.A_Position;\tEND_IF;\n\tIF Valve.Valve_Actual<2 THEN\tlcl_Status:=eACV_Status.A_Closed; END_IF;\n\tIF Valve.Valve_Actual>98 THEN\tlcl_Status:=eACV_Status.A_Open; END_IF;\n\t\nELSE\n\tIF Valve.Valve_Actual>3 AND Valve.Valve_Actual<97 THEN \tlcl_Status:=eACV_Status.M_Position;\tEND_IF;\n\tIF Valve.Valve_Actual<2 THEN\tlcl_Status:=eACV_Status.M_Closed; END_IF;\n\tIF Valve.Valve_Actual>98 THEN\tlcl_Status:=eACV_Status.M_Open; END_IF;\n\t\nEND_IF\n\n\n\n\n\nActive_TOF(IN:= (\n\t\t(\tABS(PosChange)>0.75 OR Control_Error>2)\n\t\t\tAND Valve.Valve_Actual>2 AND Valve.Valve_Actual<98),\n\t\tPT:=T#1000MS);\nActive:=Active_Tof.Q ;//OR ( ABS(Valve.Valve_Actual-Output)>5) ;\n//If Trend_Detect>0.1\t\nIF Active   AND Valve.Valve_Actual>3 AND Valve.Valve_Actual<97 THEN\n\tIF PosChange > 0 THEN \n\t\tlcl_Status:=eACV_Status.Opening;\n\tELSE\n\t\tlcl_Status:=eACV_Status.Closing;\n\tEND_IF;\nEND_IF;\n\n\n\n\n//IF output > (Valve.Valve_Actual+Error_PCT) THEN lcl_Status:=eACV_Status.Opening; END_IF;\n//IF output < (Valve.Valve_Actual-Error_PCT) THEN lcl_Status:=eACV_Status.Closing; END_IF;\n\n\n//if Active the lcl_Status:=eACV_Status.Active;\nIF Ton_1.Q THEN lcl_Status:=eACV_Status.Pos_Error;  END_IF;\nIF Position_Hold THEN lcl_Status:=eACV_Status.Positon_Hold; \tEND_IF;\nIF NOT(Permissive_NC) AND (Valve.Mode.eMode=eACV_Modes.Auto OR Valve.Mode.eMode=eACV_Modes.Simulate) THEN lcl_Status:=eACV_Status.Interlocked; END_IF;\nIF NOT(LOCKOUT_NC) THEN \tlcl_Status:=eACV_Status.LOCKED_OUT; \tEND_IF;\nIF NOT(Online) AND NOT(Valve.Mode.eMode=eACV_Modes.Simulate) THEN \tlcl_Status:=eACV_Status.OFFLINE; \tEND_IF;\nIF (Valve.Valve_Actual<>Valve.Valve_Actual) THEN \tlcl_Status:=eACV_Status.OFFLINE; \tEND_IF;\n\n\nValve.Status.eStatus:=lcl_Status;","LineInfoPersistence":"(string)6e42c030-437a-4154-a7be-a7ba8f1e2c17_Impl_LineIds"}}}},"UniqueIdGenerator":"(string)100"}},"TypeInfos":{"3b83b776":"{3b83b776-fb25-43b8-99f2-3c507c9143fc}","8ac092e5":"{8ac092e5-3128-4e26-9e7e-11016c6684f2}","f3878285":"{f3878285-8e4f-490b-bb1b-9acbb7eb04db}","string":"System.String"}}},"FormatVersion":"1.0"}